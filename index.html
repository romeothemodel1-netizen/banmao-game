<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Banmao Clicker â€“ Pool V1</title>
<script src="https://cdn.jsdelivr.net/npm/ethers@6.13.2/dist/ethers.min.js"></script>
<style>
  :root { --yellow:#ffd84d; }
  html,body{margin:0;background:#0b0b0b;color:#fff;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif}
  .wrap{max-width:980px;margin:0 auto;padding:20px}
  .card{background:#111;border:1px solid #222;border-radius:18px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.25);margin-bottom:14px}
  .row{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  .pill{background:#1a1a1a;border:1px solid #222;padding:8px 12px;border-radius:999px}
  .btn{background:var(--yellow);color:#111;border:0;padding:10px 16px;border-radius:12px;font-weight:800;cursor:pointer}
  h1{margin:0 0 10px 0;font-size:22px}
  canvas{width:100%;height:auto;background:linear-gradient(180deg,#161616 0%,#0f0f0f 100%);border-radius:12px;border:1px solid #222;display:block}
  /* Progress bar */
  .progress-wrap{margin-top:12px;background:#1a1a1a;border-radius:8px;overflow:hidden;border:1px solid #222}
  .progress-bar{height:20px;background:var(--yellow);width:0%;transition:width 0.2s ease}
  .progress-text{text-align:center;font-size:13px;margin-top:4px;color:#ccc}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <div class="row">
      <h1>Banmao Clicker â€“ Pool V1</h1>
      <div>
        <select id="walletSelect" class="pill">
          <option value="auto">Auto (OKX / MetaMask)</option>
          <option value="okx">Force OKX Wallet</option>
          <option value="metamask">Force MetaMask</option>
        </select>
        <button id="connect" class="btn">Connect Wallet</button>
        <button id="claim" class="btn">Claim BANMAO</button>
      </div>
    </div>
    <div class="row" style="margin-top:-6px;gap:10px">
      <div class="pill">Score: <b id="score">0</b></div>
      <div class="pill">BANMAO earned: <b id="earned">0</b></div>
      <div class="pill">Wallet: <span id="addr">not connected</span></div>
      <div class="pill">Balance: <b id="balance">0</b></div>
      <div class="pill">Status: <span id="status">Ready</span></div>
    </div>
    <canvas id="game" width="900" height="460" style="margin-top:12px"></canvas>

    <!-- Progress bar -->
    <div class="progress-wrap">
      <div id="progressBar" class="progress-bar"></div>
    </div>
    <div id="progressText" class="progress-text">0 / 333 BANMAO</div>
  </div>
</div>

<script>
  // ====== CONFIG ======
  const MAX_BANMAO = 333;

  let score = 0;
  const canvas = document.getElementById("game");
  const ctx = canvas.getContext("2d");

  let banana = { x: 720, y: 220, r: 34, vx: 1.1, vy: 0.9 };

  // Váº½ cÃ¡i Ä‘áº§u mÃ¨o
  function drawCatHead(){
    const x = 200, y = 250, r = 60; // tÃ¢m Ä‘áº§u mÃ¨o
    ctx.fillStyle='#ffd84d';
    ctx.beginPath(); ctx.arc(x,y,r,0,Math.PI*2); ctx.fill();

    // Tai trÃ¡i
    ctx.beginPath();
    ctx.moveTo(x-r*0.6, y-r*0.3);
    ctx.lineTo(x-r*0.2, y-r*1.0);
    ctx.lineTo(x-r*0.05, y-r*0.3);
    ctx.closePath(); ctx.fill();

    // Tai pháº£i
    ctx.beginPath();
    ctx.moveTo(x+r*0.6, y-r*0.3);
    ctx.lineTo(x+r*0.2, y-r*1.0);
    ctx.lineTo(x+r*0.05, y-r*0.3);
    ctx.closePath(); ctx.fill();

    // Máº¯t
    ctx.fillStyle='#111';
    ctx.beginPath(); ctx.arc(x-r*0.35, y-r*0.1, 6,0,Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(x+r*0.35, y-r*0.1, 6,0,Math.PI*2); ctx.fill();

    // MÅ©i
    ctx.beginPath(); ctx.moveTo(x-5,y+10); ctx.lineTo(x+5,y+10); ctx.lineTo(x,y+16); ctx.closePath(); ctx.fill();

    // Miá»‡ng
    ctx.strokeStyle='#111'; ctx.lineWidth=2;
    ctx.beginPath(); ctx.arc(x-5,y+20,7,0,Math.PI); ctx.arc(x+5,y+20,7,0,Math.PI); ctx.stroke();

    // Ria
    ctx.beginPath(); ctx.moveTo(x-20,y+5); ctx.lineTo(x-45,y); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(x-20,y+12); ctx.lineTo(x-45,y+15); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(x+20,y+5); ctx.lineTo(x+45,y); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(x+20,y+12); ctx.lineTo(x+45,y+15); ctx.stroke();
  }

  function drawBanana(){
    ctx.strokeStyle = '#ffd84d'; ctx.lineWidth = 18; ctx.beginPath();
    ctx.arc(banana.x, banana.y, banana.r, Math.PI*0.12, Math.PI*1.12); ctx.stroke();
    ctx.fillStyle = '#ffd84d'; ctx.beginPath();
    ctx.arc(banana.x + banana.r*Math.cos(Math.PI*0.12), banana.y + banana.r*Math.sin(Math.PI*0.12), 6, 0, Math.PI*2); ctx.fill();
  }

  function drawBG(){
    ctx.fillStyle='#121212'; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.strokeStyle='#1a1a1a'; ctx.lineWidth=1;
    for(let x=0;x<canvas.width;x+=32){ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,canvas.height);ctx.stroke();}
    for(let y=0;y<canvas.height;y+=32){ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(canvas.width,y);ctx.stroke();}
  }

  function animate(){
    drawBG(); drawCatHead(); drawBanana();
    banana.x += banana.vx; banana.y += banana.vy;
    if(banana.x > canvas.width-40 || banana.x < 40) banana.vx *= -1;
    if(banana.y > canvas.height-40 || banana.y < 40) banana.vy *= -1;
    requestAnimationFrame(animate);
  } animate();

  // Update progress bar
  function updateProgress(banmaoNow){
    const bar = document.getElementById('progressBar');
    const txt = document.getElementById('progressText');
    const pct = Math.min(100, (banmaoNow/MAX_BANMAO)*100);
    bar.style.width = pct+"%";
    txt.textContent = banmaoNow.toFixed(3)+" / "+MAX_BANMAO+" BANMAO";
  }

  function hit(mx,my,obj){ const dx=mx-obj.x, dy=my-obj.y; return Math.hypot(dx,dy) <= obj.r + 20; }
  canvas.addEventListener('click', (e)=>{
    const r = canvas.getBoundingClientRect();
    const mx = (e.clientX - r.left) * (canvas.width/r.width);
    const my = (e.clientY - r.top) * (canvas.height/r.height);
    if (hit(mx,my,banana)){
      const v = 10; // Ä‘iá»ƒm má»—i click
      let banmaoNow = (score+v)/10;
      if(banmaoNow > MAX_BANMAO){ 
        document.getElementById('status').textContent = "ðŸš« Max cap "+MAX_BANMAO+" BANMAO";
        return;
      }
      score += v;
      document.getElementById('score').textContent = score;
      document.getElementById('earned').textContent = (score/10).toFixed(3);
      updateProgress(score/10);
      banana.r = 40; setTimeout(()=> banana.r=34,120);
    }
  });
</script>
</body>
</html>
